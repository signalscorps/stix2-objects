{
    "$id": "https://raw.githubusercontent.com/signalscorps/stix2-objects/main/schemas/property-extension/vulnerability-pattern-extension/schema.json",
    "$schema": "http://json-schema.org/draft/2020-12/schema",
    "title": "vulnerability-pattern-extension",
    "description": "This extension extends Indicator SDOs with the information about which CPEs (referenced in the pattern property) are actually vulnerable.",
    "type": "object",
    "allOf": [
        {
            "$ref": "https://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/master/schemas/sdos/indicator.json"
        },
        {
            "properties": {
                "extensions": {
                    "extension-definition--b463c449-d022-48b7-b464-3e9c7ec5cf16": {
                        "extension_type": "property-extension",
                        "$ref": "#/$defs/vulnerability-pattern-extension",
                        "required": [
                            "extension_type",
                            "$ref"
                        ]
                    },
                    "required": [
                        "extension-definition--b463c449-d022-48b7-b464-3e9c7ec5cf16"
                    ]
                }
            }
        }
    ],
    "$defs": {
        "vulnerability-pattern-extension": {
            "type": "object",
            "description": "The set of properties define the vulnerable CPEs in the pattern property.",
            "properties": {
                "all_cpe23uris": {
                    "type": "array",
                    "description": "A list of all cpe23uri's in the pattern",
                    "items": {
                        "type": "string"
                    
                    }
                },
                "vulnerable_cpe23uris": {
                    "type": "array",
                    "description": "A list of only the cpe23uri's that are vulnerable in the pattern",
                    "items": {
                        "type": "string"
                    
                    }
                }
            },
            "required": []
        }
    }
}